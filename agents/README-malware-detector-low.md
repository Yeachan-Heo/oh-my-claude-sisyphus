# Malware Detector Low Agent (Quick Scan)

**Model:** Haiku (fast, lightweight)
**File:** `agents/malware-detector-low.md`

## Overview

The `malware-detector-low` agent is a fast, lightweight malware scanner optimized for quick threat detection. It focuses on the most critical and common malicious patterns, making it ideal for rapid checks on small code changes or individual files.

## When to Use

| Scenario | Use This Agent |
|----------|----------------|
| Quick file check | Yes |
| Small code changes | Yes |
| Pre-commit hook | Yes |
| CI/CD pipeline gate | Yes |
| Comprehensive audit | No (use `malware-detector`) |
| Deep analysis | No (use `malware-detector`) |

## Capabilities

### Priority 1: Critical Threats (Always Checked)

```javascript
// Reverse shells
spawn('sh'), spawn('bash'), exec('cmd')

// Eval injection
eval(userInput), eval(fetch(url))

// Credential theft
readFile('.ssh/id_rsa'), readFile('.aws/credentials')

// Base64 payloads
atob('encoded_malware'), Buffer.from(x, 'base64')
```

### Priority 2: High-Risk Patterns

```javascript
// Obfuscated code
var _0x1a2b = [...]

// Network backdoors
WebSocket to unknown domains

// Cryptominer signatures
stratum://, coinhive

// File encryption
crypto.encrypt + writeFile
```

### Tools Available

- `Read` - Read file contents
- `Grep` - Pattern search
- `Glob` - File discovery
- `Bash` - Run quick scans

## Usage

### Quick Scan a File
```
quickly scan src/utils/helper.js for malware
```

### Pre-commit Check
```
fast malware check on staged files
```

### CI/CD Integration
```
run a quick security scan before merge
```

## Output Format

The agent produces a concise, fast report:

```markdown
## Quick Malware Scan

**Status:** CLEAN | SUSPICIOUS | INFECTED
**Files Checked:** 5
**Time:** <5 seconds

### Findings
- No critical threats detected

### Recommendation
- No action required
```

## Comparison: Low vs Full Agent

| Aspect | malware-detector-low | malware-detector |
|--------|---------------------|------------------|
| Model | Haiku | Opus |
| Speed | Fast (<10s) | Thorough (1-5min) |
| Patterns | Top 20 critical | 60+ comprehensive |
| Depth | Surface scan | Deep analysis |
| Supply chain | Basic | Full audit |
| Report | Concise | Detailed |
| Cost | Low | Higher |
| Use case | Quick checks | Full audits |

## Scan Commands Used

```bash
# Fast critical threat scan
grep -rn "eval\|spawn\|exec(" --include="*.js" . | head -50

# Credential access check
grep -rn "\.ssh\|\.aws\|passwd\|credentials" --include="*.js" . | head -50

# Obfuscation detection
grep -rn "_0x[0-9a-f]\|atob\|base64" --include="*.js" . | head -50
```

## Risk Assessment

| Finding | Action |
|---------|--------|
| Critical pattern found | Escalate to full `malware-detector` |
| Suspicious code | Manual review recommended |
| Clean | Proceed with confidence |

## Escalation Path

If the quick scan finds concerning patterns:

```
Quick scan found suspicious patterns in 3 files.
Recommend running full malware-detector agent for deep analysis.
```

Then escalate:
```
/oh-my-claudecode:malware-scan
```

## Example Session

```
User: quick malware check on the new PR

Agent: Running quick malware scan on changed files...

## Quick Malware Scan

**Status:** CLEAN
**Files Checked:** 8
**Time:** 3 seconds

### Findings
- No critical threats detected
- 1 use of child_process (in build script - expected)

### Recommendation
- Safe to proceed with merge
```

## Integration Examples

### Git Pre-commit Hook
```bash
#!/bin/bash
# .git/hooks/pre-commit
claude "quick malware scan on staged files" --quiet
```

### CI/CD Pipeline
```yaml
security-gate:
  script:
    - claude "fast malware check on diff" --exit-code
```

## Limitations

- Only checks top 20 critical patterns
- No supply chain analysis
- No behavioral analysis
- May miss sophisticated threats
- For comprehensive scanning, use `malware-detector`

## Related Agents

- `malware-detector` - Full comprehensive scan (Opus)
- `security-reviewer` - General security review
- `code-reviewer-low` - Quick code quality check
